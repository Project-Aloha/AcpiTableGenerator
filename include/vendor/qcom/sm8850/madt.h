#pragma once
#include "table_header.h"
#include <common/madt.h>

#define GICD_BASE_ADDRESS 0x17000000ULL
#define GIC_ITS_BASE_ADDRESS 0x17040000ULL
#define GICR_BASE_ADDRESS 0x17080000ULL
#define GICR_STRIDE 0x40000ULL
#define GICC_PERFORMANCE_INTERRUPT_GSI 0x17
#define GICC_VGIC_MAINTENANCE_INTERRUPT 0x19
#define GICC_MPIDR_CORE0 0x00000000ULL
#define GICC_MPIDR_CORE1 0x00000100ULL
#define GICC_MPIDR_CORE2 0x00000200ULL
#define GICC_MPIDR_CORE3 0x00000300ULL
#define GICC_MPIDR_CORE4 0x00000400ULL
#define GICC_MPIDR_CORE5 0x00000500ULL
#define GICC_MPIDR_CORE6 0x00010000ULL
#define GICC_MPIDR_CORE7 0x00010100ULL
#define GIC_VERSION GIC_V3
#define NUM_ITS 1

MADT_DEFINE_TABLE(NUM_CORES, NUM_ITS, ACPI_MADT_TABLE_STRUCTURE_NAME);
MADT_DEFINE_WITH_MAGIC;

MADT_START{
    /* Table Header */
    MADT_DECLARE_HEADER,
    MADT_DECLARE_HEADER_EXTRA_DATA(0, 0),
    /* GICD Structure */
    MADT_DECLARE_GICD_STRUCTURE(GICD_BASE_ADDRESS, GIC_VERSION),

    /* GIC ITS Structure */
    MADT_DECLARE_GIC_ITS_STRUCTURE(0, GIC_ITS_BASE_ADDRESS, 0),

    /* GICC Structure */
    MADT_DECLARE_GICC_STRUCTURE(0, 0, GICC_MPIDR_CORE0), // Core 0
    MADT_DECLARE_GICC_STRUCTURE(1, 1, GICC_MPIDR_CORE1), // Core 1
    MADT_DECLARE_GICC_STRUCTURE(2, 2, GICC_MPIDR_CORE2), // Core 2
    MADT_DECLARE_GICC_STRUCTURE(3, 3, GICC_MPIDR_CORE3), // Core 3
    MADT_DECLARE_GICC_STRUCTURE(4, 4, GICC_MPIDR_CORE4), // Core 4
    MADT_DECLARE_GICC_STRUCTURE(5, 5, GICC_MPIDR_CORE5), // Core 5
    MADT_DECLARE_GICC_STRUCTURE(6, 6, GICC_MPIDR_CORE6), // Core 6
    MADT_DECLARE_GICC_STRUCTURE(7, 7, GICC_MPIDR_CORE7), // Core 7
} MADT_END;
